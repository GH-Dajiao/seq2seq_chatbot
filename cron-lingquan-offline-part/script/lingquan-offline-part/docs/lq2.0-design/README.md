# 领券平台-数据服务-优化点


## 1. 业务优化点 

> 调整数据结构后，体现在业务上的优化点汇总

Type | 原版本 | 优化版本 | Desc
------- | ------- | -------  | -------
卡券属性 实时性 | 更新频率 1day <br><br> 1. 球内卡券库存 <br> 2. 球内卡券已售 <br> 3. 球内卡券价格 | 更新频率 10分钟 <br><br> 1. 球内卡券库存 <br> 2. 球内卡券已售 <br> 3. 球内卡券价格 | -
user 与 coupon、shop <br> 平面距离误差 | <= 554m (杭州主区) | < 250m(杭州主区) | 不同城市不同
coupon 是否支持多类别 | 不支持 | 支持 | 一张卡券可同属于 (美食、娱乐)
热销券 距离显示优化 | 未显示距离 | 可按距离排序，并显示距离
集团coupon适用多个shop，销量排序后显示距离优化| 不能显示券所属shop的最近距离 | 可显示最近的距离 | -

## 2. 技术优化点

### 2.1 地标优惠券商户中间表存储优化

首页-附近的券，店数量，列表数据存在中间表
杭州面积16596平方千米 ，1000个地标精确到500米

test_seek_third4_landmark_coupon_hangzhou
test_seek_third4_landmark_shop_hangzhou

一个地标存6个距离段，每个距离段300条数据，=1800条数据

杭州主城区1000个地标，总共1800000条数据=180万数据，每条数据最大1k字节

总量：933M

优化方案：
一个地标存6个距离段，每个距离段存1条数据，1条数据最多存300个券或者店=6条数据

杭州主城区10000个地标，总共条数据=60000条数据，每条数据最大21k字节
总量：270M

综上：杭州主城区存储量由933M降为270M

### 2.2 优惠券存储优化：

老版本：55.4Mi/116Mi    36.9k

新版本：21.3Mi/42.7Mi   25.3k

### 2.3 搜索优化：

由于之前1条券属于不同的店会存多条记录，搜索时需要进行聚合操作，性能消耗比较大，
优化方案后不会出现聚合操作，提高搜索性能
...
...

## 人员分工

Author | content 
------- | -------
颜腾威 | 1. 外部数据抓取领券（点评，天猫，enjoy及后续）及临时需求抓取 <br> 2. 外部抓取数据导入与同步 <br> 3. 机器人项目微信公众号跟进 <br> 4. 网易七鱼机器人api接入
厉海军 | 1. 数据服务接口 <br> 2. 内部数据导入与同步  <br> 3. 商圈地标录入界面化<br> 4. 用户画像结构设计 <br> 5. 参与推荐系统设计与数据导入 | 
陈立宾 | 1. 数据离线计算 <br> 2. 多店合一 <br> 3. 用户画像结构设计 <br> 4. 推荐系统设计 <br> 5. 兴趣标签扩展 | 


